---
title: "Assignment 5"
author: "Alex Ivina"
date: "November 26, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(tidyverse)
grad_enrollment<- read_csv("Grad_enrollment_1967 - 2015.csv")
library(effsize)
faculty_salary<- read_csv("faculty_salary.csv")
```

1. Male and female graduate enrollment (1967 - 2015). Compare trends in total graduate enroll- ment for males and females (including full-time/part-time and private/public universities) in the United States from 1967 - 2015. Describe your results statistically, graphically and in text.

```{r}
#RESEARCH QUESTION: Does gender effect college enrollment rate


# Create a data set of male and female total enrollments
# look into regressions between genders
# Create a graphic

# data set of only totals for males and females
gender_totals<- grad_enrollment %>% 
  select(Year,Total,Total_Males, Total_Females)
gender_totals

#exploratory graphs
male_qq<- ggplot(gender_totals, aes(sample = Total_Males))+
  geom_qq()
male_qq
# data appears linear
male_hist<- ggplot(gender_totals, aes(x = Total_Males))+
  geom_histogram()
male_hist
# male enrollment appears relativly normally distributed


# Look into regression to see if there is a correlation between gender and college enrollment
gender_model_male<- lm(Total_Males~Year, data = gender_totals)
gender_model_male
# male_enrollment= -17112153 + 9069(Year)

# look to see if assumtions are met for regression
plot(gender_model_male)
# data look normal and linear the risiduals seem to be possibly 
summary(gender_model_male)
# R^2: 85 percent of male enrollment rate is determined by year
# p-value: variables are highly significant (p-value = 0)

male_enrollment_graph<- ggplot(gender_totals, aes(y = Total_Males, x = Year))+
  geom_point()+
  geom_smooth(method = lm, se = TRUE, color = "chartreuse")+
  labs(y="Number of Students Enrolled", x = "Year")
male_enrollment_graph

######################################
# Look at the same qustion for women
#####################################

#exploratory graphs
female_qq<- ggplot(gender_totals, aes(sample = Total_Females))+
  geom_qq()
female_qq
# female enrollment data appeaes linear
female_hist<- ggplot(gender_totals, aes(x = Total_Females))+
  geom_histogram()
female_hist
# female data seem like it may not be normally distributed

#Look at a regression between year and female enrollment rate
female_model<- lm(Total_Females~Year, data = gender_totals)
female_model
# female_enrollment = -58955502 + 30126 (Year)

# look to see if assumtions are met for regression
plot(female_model)
# assumtions seem to be met, some worry with equal variances of risiduals
summary(female_model)
# R^2: 98% of female college enrollment rate is determined by year
# p-value: both variables are highly significant (p-vlaue = 0)

# create a  final graphic for female enrollment rate

female_enrollment_graph<- ggplot(gender_totals, aes(x = Year, y = Total_Females))+
  geom_point()+
  geom_smooth(method = lm, se = TRUE, color = "orchid")+
  labs(y = "Number of Students Enrolled", x = "Year")
female_enrollment_graph


# Create one graph of males and females
enrollment_graph<- ggplot(gender_totals, aes(Year))+
  geom_line(aes(y = Total_Males, colour = "Total Males"))+
  geom_line(aes(y = Total_Females, colour = "Total Females"))+
  labs(title = "Male & Female College Enrollment U.S. (1967-2015)", x = "Year", y = "Number of Student Enrolled", colour = "Gender of Student")+
  scale_y_continuous(expand = c(0,0))+
  scale_x_continuous(expand = c(0,0), limits = c(1967,2015))+
  theme_dark()

enrollment_graph

  

```


4. Exploring academic salaries for professors in U.S. colleges. Explore relationships between
variables in the ‘Faculty salary data (2008 - 2009 survey)’ dataset. Develop a model describing faculty
salary based on data for faculty sex, rank, years in current position, field, and number of years since
doctoral degree was earned. You should make decisions regarding which variables should remain in your
final model. Describe the results qualitatively and quantitatively (i.e., don’t just report the statistical
results of the model – make sure you describe interesting findings in text). You can also discuss any
concerns that you have with the model(s) you present, if any

```{r}
# data wrangling
faculty_salary1<- faculty_salary %>% 
  mutate(Discipline = case_when
         (`Discipline (A = Theoretical, B = Applied)` == "B" ~ "Apllied", 
                  `Discipline (A = Theoretical, B = Applied)`  == "A" ~"Theoretical")) %>% 
  select(-`Discipline (A = Theoretical, B = Applied)`) 

names(faculty_salary1)<- c("faculty_rank", "years_since_phd", "years_employed", "sex", "salary", "discipline")

faculty_salary1

# Exploratory graphs for salary
salary_qq<- ggplot(faculty_salary1, aes(sample = salary))+
  geom_qq()
salary_qq
# salary data looks linear
salary_hist<- ggplot(faculty_salary1, aes(x = salary))+
  geom_histogram()
salary_hist
# salary looks relatively normal

#################
# Create a model for salary
#################

salary_model<- lm(salary~faculty_rank + years_since_phd + years_employed + sex + discipline, data = faculty_salary1)
salary_model

# salary = 93280.4 + 535.1(years_since_phd) - 14417.6(discipline_theoretical) -12907.6(faculty_rankAsstProf) + 32158.4(faculty_rankProf) - 489.5(years_employed) + 4783.5(sexMale)











```









